#!/usr/bin/perl -w

use autodie qw(:all);
use File::HomeDir;
use strict;

my $home = File::HomeDir->my_home();

if(open(my $fin, '-|', 'locate .git')) {
	foreach my $line(<$fin>) {
		chomp $line;
		next unless($line =~ /\.git$/);
		next unless($line =~ /\Q$home\E\/src/);
		next unless(-r "$line/config");
		$line =~ s/\/\.git$//;
		print "$line\n";
		chdir $line;
		system('git pull');
	}
}

system('perlbrew self-upgrade');

# system("perlbrew exec perl -MCPAN -e 'CPAN::Shell->upgrade'");
